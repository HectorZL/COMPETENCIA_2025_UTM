{% extends "base.html" %}

{% block 'head' %}
<title>Editar Perfil</title>
<style>
  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }
  .form-card {
    background-color: white;
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    padding: 2rem;
  }
  .form-group {
    margin-bottom: 1.5rem;
  }
  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
  }
  .form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 1rem;
  }
  .form-control:focus {
    outline: 2px solid #4f46e5;
    outline-offset: -1px;
  }
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.375rem;
    font-size: 1rem;
    font-weight: 500;
    padding: 0.75rem 1.5rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-primary {
    background-color: #4f46e5;
    color: white;
    border: none;
  }
  .btn-primary:hover {
    background-color: #4338ca;
  }
  .btn-secondary {
    background-color: #f3f4f6;
    color: #1f2937;
    border: 1px solid #d1d5db;
  }
  .btn-secondary:hover {
    background-color: #e5e7eb;
  }
  .header-bar {
    display: flex;
    align-items: center;
    padding: 1rem;
    background-color: white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
  }
</style>
{% endblock 'head' %}

{% block 'body' %}
<!-- Header bar -->
<div class="header-bar">
  <div class="container">
    <div class="flex items-center justify-between w-full">
      <div class="flex items-center gap-3">
        <a href="{% url 'dashboard' %}" class="text-gray-500 hover:text-gray-700 no-underline">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
        </a>
        <h1 class="text-xl font-bold">Editar Perfil</h1>
      </div>
      <div>
        <a href="{% url 'dashboard' %}" class="text-indigo-600 hover:text-indigo-500 no-underline hover:underline">Volver al Dashboard</a>
      </div>
    </div>
  </div>
</div>

<div class="container">
  {% if messages %}
    {% for message in messages %}
      <div class="rounded-md {{message.tags}} mb-6 p-4">
        <div class="flex">
          <div class="ml-3">
            <p class="text-base">{{message}}</p>
          </div>
        </div>
      </div>
    {% endfor %}
  {% endif %}

  <div class="form-card">
    <form method="POST" action="{% url 'edit_profile' %}">
      {% csrf_token %}
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Datos comunes para todos los usuarios -->
        <div>
          <h2 class="text-xl font-semibold mb-4">Información Personal</h2>
          
          <div class="form-group">
            <label for="nombre" class="text-base font-medium">Nombre completo</label>
            <input type="text" id="nombre" name="nombre" value="{{ user.Nombre }}" required class="form-control">
          </div>
          
          <div class="form-group">
            <label for="email" class="text-base font-medium">Correo electrónico</label>
            <input type="email" id="email" name="email" value="{{ user.Email }}" required class="form-control">
          </div>
          
          <div class="form-group">
            <label for="telefono" class="text-base font-medium">Teléfono</label>
            <input type="text" id="telefono" name="telefono" value="{{ user.Telefono }}" 
                   pattern="09[0-9]{8}" title="El número debe comenzar con 09 y tener 10 dígitos en total"
                   required class="form-control">
            <p class="text-sm text-gray-500 mt-1">Formato: 09XXXXXXXX (10 dígitos)</p>
          </div>
        </div>
        
        <div>
          <!-- Campos específicos según tipo de usuario -->
          {% if is_doctor %}
            <h2 class="text-xl font-semibold mb-4">Información Profesional</h2>
            
            <div class="form-group">
              <label for="especialidad" class="text-base font-medium">Especialidad</label>
              <input type="text" id="especialidad" name="especialidad" value="{{ user.Especialidad }}" class="form-control">
            </div>
          {% else %}
            <h2 class="text-xl font-semibold mb-4">Información Adicional</h2>
            
            <div class="form-group">
              <label for="genero" class="text-base font-medium">Género</label>
              <select id="genero" name="genero" class="form-control">
                <option value="Masculino" {% if user.Genero == 'Masculino' %}selected{% endif %}>Masculino</option>
                <option value="Femenino" {% if user.Genero == 'Femenino' %}selected{% endif %}>Femenino</option>
                <option value="Otro" {% if user.Genero == 'Otro' %}selected{% endif %}>Otro</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="fecha_nacimiento" class="text-base font-medium">Fecha de nacimiento</label>
              <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" 
                     value="{% if user.FechaNacimiento %}{{ user.FechaNacimiento|date:'Y-m-d' }}{% endif %}" 
                     class="form-control">
            </div>
          {% endif %}
          
          <!-- Cambio de contraseña -->
          <h2 class="text-xl font-semibold mb-4 mt-6">Cambiar Contraseña</h2>
          
          <div class="form-group">
            <label for="password" class="text-base font-medium">Nueva contraseña</label>
            <input type="password" id="password" name="password" class="form-control">
            <p class="text-sm text-gray-500 mt-1">Dejar en blanco para mantener la contraseña actual</p>
          </div>
        </div>
      </div>
      
      <div class="mt-8 flex justify-end gap-4">
        <a href="{% url 'dashboard' %}" class="btn btn-secondary">Cancelar</a>
        <button type="submit" class="btn btn-primary">Guardar cambios</button>
      </div>
    </form>
  </div>
</div>
{% endblock 'body' %} 